/**
 * @qymh/q-select v0.4.7
 * (c) 2020 Qymh
 * @license MIT
 */
var t,e;t=this,e=function(){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)},e=function(){return(e=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var a in e=arguments[i])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)};function i(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),a=0;for(e=0;e<i;e++)for(var o=arguments[e],s=0,r=o.length;s<r;s++,a++)n[a]=o[s];return n}var n=function(){function t(){this.initialDomString=""}return t.prototype.init=function(t,e,i,n){var a=this,o=e.id,s=e.loading,r=Math.floor(e.count/2)*e.chunkHeight;i||(this.initialDomString+='\n        <div class="q-select-header q-select-header--'+o+'" style="height:45px;padding-left:20px;padding-right:20px;">\n          <div class="q-select-header-cancel q-select-header-cancel--'+o+'" style="width:100px; font-size:14px;">\n            <div class="q-select-header-cancel__value q-select-header-cancel__value--'+o+'">'+(e.cancelBtn||"\u53d6\u6d88")+'</div>\n          </div>\n          <div class="q-select-header-title q-select-header-title--'+o+'">\n            <div class="q-select-header-title__value q-select-header-title__value--'+o+'">'+(e.title||"\u8bf7\u9009\u62e9")+'</div>\n          </div>\n          <div class="q-select-header-confirm q-select-header-confirm--'+o+'" style="width:100px; font-size:14px;">\n            <div class="q-select-header-confirm__value q-select-header-confirm__value--'+o+'">'+(e.confirmBtn||"\u786e\u5b9a")+"</div>\n          </div>\n        </div>\n      "),this.initialDomString+='\n      <div style="height:'+e.count*e.chunkHeight+"px;display:"+(s?"flex":"none")+'" class="q-select-loading q-select-loading--'+o+'">\n        <svg class="q-select-loading-svg" viewBox="25 25 50 50" style="height:30px; width:30px;">\n          <circle\n            class="q-select-loading-svg__circle"\n            cx="50"\n            cy="50"\n            r="20"\n            fill="none"\n          />\n        </svg>\n      </div>\n      <div style="height:'+e.count*e.chunkHeight+'px" class="q-select-box q-select-box--'+o+'">\n    ',t.forEach((function(t){a.initialDomString+='\n      <div class="q-select-box-item q-select-box-item--'+o+' q-select-flex">\n        <div class="q-select-box-item__overlay q-select-box-item__overlay--'+o+'" style="background-size: 100% '+(s?"100%":r+"px")+';"></div>\n        <div class="q-select-box-item__highlight q-select-box-item__highlight--'+o+'" style="top: '+r+"px;height: "+e.chunkHeight+'px"></div>\n        <div class="q-select-box-item-collections q-select-box-item-collections--'+o+'">\n        '+t.map((function(t){return'<div style="line-height: '+e.chunkHeight+'px;" class="'+(t.disabled?"q-select-box-item-collections__tick--disabled":"")+" q-select-box-item-collections__tick q-select-box-item-collections__tick--"+o+'">\n              '+t.value+"\n            </div>"})).join("")+"\n        </div>\n      </div>\n      "})),n(this.initialDomString)},t.prototype.remove=function(){this.initialDomString=""},t.diff=function(e,i,n,a,o,s,r,h){var l=t.findAll("q-select-box-item-collections--"+a),d=t.find("q-select-box--"+a);if(e.length<i.length)if(l.length<i.length){for(var c=[],u=[],f=[],p=r?n:n+1;p<e.length;p++){var y=l[p];t.diffForDatas(y,a,o,s[p].data,i[p])}for(var m=l.length;m<i.length;m++){var g=document.createDocumentFragment(),v=t.create("div");t.addClass(v,["q-select-box-item","q-select-flex","q-select-box-item--"+a]);var x=t.create("div");t.addClass(x,["q-select-box-item__overlay","q-select-box-item__overlay--"+a]);var b=t.create("div");t.addClass(b,["q-select-box-item__highlight","q-select-box-item__highlight--"+a]),t.addStyle(b,{height:o+"px"}),v.appendChild(x),v.appendChild(b);var I=t.create("div");for(t.addClass(I,["q-select-box-item-collections","q-select-box-item-collections--"+a]),p=0;p<i[m].length;p++){var D=t.create("div");t.addClass(D,["q-select-box-item-collections__tick","q-select-box-item-collections__tick--"+a]),t.addStyle(D,{lineHeight:o+"px"}),D.textContent=i[m][p].value,g.appendChild(D)}I.appendChild(g),v.appendChild(I),d.appendChild(v),c[m]=x,u[m]=I,f[m]=b}h&&h(c,u,f)}else{for(p=r?n:n+1;p<i.length;p++)y=t.findIndex("q-select-box-item-collections--"+a,p),t.diffForDatas(y,a,o,s[p].data,i[p]);h&&h()}else if(e.length===i.length){for(p=r?n:n+1;p<i.length;p++)t.diffForDatas(l[p],a,o,e[p],i[p]);h&&h()}else if(e.length>i.length){for(p=r?n:n+1;p<i.length;p++)t.diffForDatas(l[p],a,o,e[p],i[p]);h&&h()}},t.diffForDatas=function(e,n,a,o,s){var r=s.length-o.length,h=o.length,l=s.length;if(r>0){for(var d=document.createDocumentFragment(),c=0;c<h;c++){var u=s[c],f=u.value,p=u.disabled;(g=e.children[c]).textContent=f,p?t.addClass(g,"q-select-box-item-collections__tick--disabled"):t.removeClass(g,"q-select-box-item-collections__tick--disabled")}for(c=h;c<l;c++){var y=document.createElement("div"),m=s[c];f=m.value,p=m.disabled,t.addClass(y,["q-select-box-item-collections__tick","q-select-box-item-collections__tick--"+n]),p&&t.addClass(y,["q-select-box-item-collections__tick--disabled"]),t.addStyle(y,{lineHeight:a+"px"}),y.textContent=f,d.appendChild(y)}e.appendChild(d)}else{for(c=0;c<l;c++){var g,v=s[c];f=v.value,p=v.disabled,(g=e.children[c]).textContent=f,p?t.addClass(g,"q-select-box-item-collections__tick--disabled"):t.removeClass(g,"q-select-box-item-collections__tick--disabled")}var x=i(Array.from(e.children));for(c=l;c<h;c++)e.removeChild(x[c])}},t.create=function(t){return document.createElement(t)},t.find=function(t){return document.querySelector("."+t)},t.findIndex=function(t,e){return Array.from(document.querySelectorAll("."+t))[e]},t.findLast=function(t){var e=Array.from(document.querySelectorAll("."+t));return e[e.length-1]},t.addClass=function(t,e){if(Array.isArray(e))e=e.filter((function(e){return!t.classList.contains(e)}));else if(t.classList.contains(e))return;var i=Array.isArray(e)?e.join(" "):e;t.className+=" "+i},t.removeClass=function(t,e){var i;Array.isArray(e)?(i=t.classList).remove.apply(i,e):t.classList.remove(e)},t.addStyle=function(t,e){var i=this;if(Array.isArray(e))e.map((function(e){return i.addStyle(t,e)}));else for(var n in e)t.style[n]=e[n]},t.remove=function(t,e){e&&t.removeChild(e)},t.findAll=function(t){return document.querySelectorAll("."+t)},t.bind=function(t,e,i,n){t.addEventListener(e,i,n)},t.unbind=function(t,e){t.removeEventListener(e,(function(){}))},t}();function a(t){return"Object"===Object.prototype.toString.call(t).slice(8,-1)}function o(t){return isFinite(t)}function s(t,e){return!!t||Boolean(console.error("[SelectQ]: "+e))}function r(t,e){return!!t||Boolean(console.warn("[SelectQ]: "+e))}function h(t){if(Array.isArray(t))return t.map((function(t){return h(t)}));if(a(t)){var e={};for(var i in t){var n=t[i];e[i]=a(n)?h(n):n}return e}return t}window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame,window.cancelAnimationFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame;var l=function(){function t(t){void 0===t&&(t=200),this.start=0,this.end=0,this.diff=0,this.dir="bottom",this.count=0,this.ratio=0,this.result=0,this.animateId=0,this.duration=t,this.pipline=!0}return t.prototype.getAnimateCount=function(t){return t/16},t.prototype.getDirection=function(){return this.start>this.end?"top":"bottom"},t.prototype.run=function(t,e,i,n,a){t!==e&&0!==a?(this.pipline=!0,this.ratio=0,this.start=t,this.end=e,this.result=t,this.diff=Math.abs(this.start-this.end),this.count=Math.ceil(this.getAnimateCount(a||this.duration)),this.dir=this.getDirection(),this.doAnimate(i,n)):n&&n(e)},t.prototype.stop=function(){this.pipline=!1,this.ratio=0,window.cancelAnimationFrame(this.animateId)},t.prototype.doAnimate=function(t,e){var i;this.pipline&&(this.ratio+=1/this.count,this.ratio<=1?(this.result=this.start+this.diff*(i=this.ratio,Math.pow(i-1,3)+1)*("bottom"===this.dir?1:-1),this.animateId=window.requestAnimationFrame(this.doAnimate.bind(this,t,e))):(this.result=this.end,window.cancelAnimationFrame(this.animateId),e&&e(this.end),this.ratio=0),t&&t(this.result))},t}(),d=function(){function t(t,e,i,n,a,o,s,r,h){this.overlay=i,this.collection=n,this.hightlightEl=a,this.pre=s,this.endCall=r,this.curIndex=o,this.preIndex=o,this.preTrans=0,this.animateSlide=new l(2e3),this.animateShrink=new l(250),this.data=t,this.average=Math.floor(s.count/2),this.maxScrollTop=0,this.minScrollTop=0,this.featureScrollTop=0,this.isAnimating=!1,this.aim=e,this.hidden=!1,this.lastTime=0,this.positions=[],this.touchStart=0,this.touchDiff=0,this.fromDiff=h||!1,this.init()}return t.prototype.init=function(){n.bind(this.overlay,"touchstart",this.doTouchStart.bind(this)),n.bind(this.overlay,"touchmove",this.doTouchMove.bind(this)),n.bind(this.overlay,"touchend",this.doTouchEnd.bind(this)),this.initTrans()},t.prototype.active=function(t){n.removeClass(n.findIndex("q-select-box-item--"+this.pre.id,t),"q-select-none"),n.addClass(n.findIndex("q-select-box-item--"+this.pre.id,t),"q-select-flex"),this.hidden=!1},t.prototype.deactive=function(t){n.removeClass(n.findIndex("q-select-box-item--"+this.pre.id,t),"q-select-flex"),n.addClass(n.findIndex("q-select-box-item--"+this.pre.id,t),"q-select-none"),this.hidden=!0},t.prototype.reset=function(t,e){this.data=t,this.preIndex=this.curIndex,this.setMinScrollTop(this.data),e?(this.preIndex=0,this.curIndex=0,this.scrollTo(0)):this.scrollTo(this.pre.dynamicIndex[this.aim])},t.prototype.initTrans=function(){var t=(this.average-this.curIndex)*this.pre.chunkHeight;this.preTrans=t,this.initScrollTop(this.average*this.pre.chunkHeight),this.setTrans(t),this.fromDiff&&this.setSize()},t.prototype.setSize=function(){var t=Math.floor(this.pre.$options.count/2)*this.pre.$options.chunkHeight;n.addStyle(this.overlay,{backgroundSize:"100% "+t+"px"}),this.hightlightEl&&n.addStyle(this.hightlightEl,{top:t+"px"})},t.prototype.shrinkSize=function(){n.addStyle(this.overlay,{backgroundSize:"100% 100%"})},t.prototype.initScrollTop=function(t){this.maxScrollTop=t,this.setMinScrollTop(this.data)},t.prototype.setMinScrollTop=function(t){this.minScrollTop=this.maxScrollTop-(t.length-1)*this.pre.chunkHeight},t.prototype.setTrans=function(t){this.collection.style.transform="translate3d(0,"+t+"px,0)"},t.prototype.getTouchCenter=function(t){return t.length>=2?(t[0].pageY+t[1].pageY)/2:t[0].pageY},t.prototype.doTouchStart=function(t){this.data.length&&!this.data.every((function(t){return t.disabled}))&&(this.touchStart=this.getTouchCenter(t.touches),this.animateSlide.stop(),this.animateShrink.stop())},t.prototype.doTouchMove=function(t){if(t.preventDefault(),this.data.length&&!this.data.every((function(t){return t.disabled}))){var e=t.timeStamp;this.touchDiff=this.getTouchCenter(t.touches)-this.touchStart+this.preTrans,this.touchDiff>this.maxScrollTop+.4*this.pre.$options.chunkHeight&&(this.touchDiff=this.maxScrollTop+.4*this.pre.$options.chunkHeight),this.touchDiff<this.minScrollTop-.4*this.pre.$options.chunkHeight&&(this.touchDiff=this.minScrollTop-.4*this.pre.$options.chunkHeight),this.positions.length>60&&this.positions.splice(0,30),this.positions.push({top:this.touchDiff,time:e}),this.lastTime=e,this.setTrans(this.touchDiff)}},t.prototype.doTouchEnd=function(t){if(this.data.length&&!this.data.every((function(t){return t.disabled}))){var e=t.timeStamp;this.isAnimating=!0,e-this.lastTime<=100?this.doSlideAnimate(e):this.doShrinkAnimate()}},t.prototype.doSlideAnimate=function(t){var e,i=this.positions.length-1,n=this.positions.filter((function(e){return e.time>=t-100}))[0],a=this.positions[i].time-n.time,o=this.touchDiff-n.top;e=o/a*(1e3/60);var s,r=this.touchDiff,h=0,l=!1;for(this.positions.length=0;Math.abs(e)>=.1;){if(h+=16,(r+=e*=.95)>=this.maxScrollTop){l=!0,r=this.maxScrollTop,s=this.maxScrollTop+.4*this.pre.$options.chunkHeight;break}if(r<=this.minScrollTop){l=!0,r=this.minScrollTop,s=this.minScrollTop-.4*this.pre.$options.chunkHeight;break}}this.preIndex=this.curIndex;var d=this.getFeatureIndex(r);d=this.getDisabledAfterIndex(d);var c=l?r:this.getFeatureScrollTop(d);Math.abs(o)<=10||h<=250?this.shrinkAnimateToEnd(c,void 0,s):this.slideAnimateToEnd(c,h,s)},t.prototype.doShrinkAnimate=function(){this.shrinkAnimateToEnd(this.touchDiff)},t.prototype.scrollTo=function(t){var e=this.getFeatureScrollTop(t||0);this.shrinkAnimateToEnd(e,!0)},t.prototype.getDisabledAfterIndex=function(t){for(;this.data[t].disabled;)if(++t===this.data.length){t--;break}if(t===this.data.length-1)for(;this.data[t].disabled;)t--;return t},t.prototype.slideAnimateToEnd=function(t,e,i){var n=this;this.animateSlide.run(this.touchDiff,i||t,(function(t){n.touchDiff=t,n.preTrans=t,n.setTrans(t)}),(function(e){i?n.shrinkAnimateToEnd(t):n.animateFinishedCall(e)}),e)},t.prototype.shrinkAnimateToEnd=function(t,e,i){var n=this,a=this.getFeatureIndex(t);a=this.getDisabledAfterIndex(a),t=this.getFeatureScrollTop(a),this.animateShrink.run(this.touchDiff,i||t,(function(t){n.setTrans(t),n.preTrans=t,n.touchDiff=t}),(function(a){i?n.shrinkAnimateToEnd(t):n.animateFinishedCall(a,e)}),e?0:250)},t.prototype.animateFinishedCall=function(t,i){if(this.isAnimating=!1,this.preTrans=t,this.touchDiff=t,this.setTrans(t),this.curIndex=this.getFeatureIndex(t),this.preIndex!==this.curIndex&&!i){var n=this.data[this.curIndex];this.fromDiff||this.endCall(e(e({},n),{index:this.curIndex}),this.aim),this.preIndex=this.curIndex}},t.prototype.getFeatureIndex=function(t){var e=this.average-Math.round(t/this.pre.chunkHeight),i=this.data.length;return e<0?0:e>i-1?i-1:e},t.prototype.getFeatureScrollTop=function(t){return(this.average-t)*this.pre.chunkHeight},t.prototype.destroy=function(){n.unbind(this.overlay,"touchstart"),n.unbind(this.overlay,"touchmove"),n.unbind(this.overlay,"touchend")},t}(),c=0;function u(t,e,i,n){var a=!1;return t.forEach((function(t,o){var r;s(0===(r=t)||!!r,e[o]+" is required as the "+o+" argument of "+i)||(a||(a=!0),n&&n())})),a}return function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}(o,e),o.prototype.setColumnData=function(t,e){var n=this;return new Promise((function(a,o){try{if(u([t,e],["column","data"],"setColumnData",o))return;if(n.touchs.filter((function(t){return!t.hidden})).some((function(t){return t.isAnimating})))return void o("[SelectQ]: Please wait for animating stops");var s=i(n.dataTrans),r=[];if(Array.isArray(t))for(var l=0,d=0,c=t;d<c.length;d++)r[+c[d]]=e[l],l++;else r=e;var f=Array.isArray(t)?t[t.length-1]+1:t+1,p=Array.isArray(t)?t[0]:t,y=Array.isArray(t)?r:[r];n.validateData(y,!1)?(n.normalizeData(r,t),n.dataTrans=n.dataTrans.slice(0,f).filter((function(t){return t.length})),n.normalizeIndex(n.dataTrans,n.dynamicIndex),n.realIndex=i(n.dynamicIndex),n.diff(s,n.dataTrans,p,!0,!0,!0),n.realData=h(n.dynamicData),a(n.getChangeCallData())):o()}catch(t){o(t)}}))},o.prototype.scrollTo=function(t,e){if(!u([t,e],["column","index"],"scrollTo")){var n=i(this.dynamicIndex);return n[t]=e,this.setIndex(n)}},o.prototype.setIndex=function(t){var e=this;return new Promise((function(i,n){try{u([t],["index"],"setIndex",n),e.validateIndex(t)?(e._setIndex(t,n),i(e.getChangeCallData())):n()}catch(t){n(t)}}))},o.prototype._setIndex=function(t,e,n,a){var o=this;if(this.touchs.filter((function(t){return!t.hidden})).some((function(t){return t.isAnimating})))e("[SelectQ]: Please wait for animating stops");else{var s,r,l=i(this.dynamicIndex);if(this.dynamicIndex=i(t),this.realIndex=i(t),r=t,(s=l).length!==r.length||!s.every((function(t,e){return t===r[e]}))||a){if(this.isGanged){var d=this.genGangedData(this.data,this.dynamicIndex);this.diff(n||this.dataTrans,d,0,!0,!1,!0),this.realIndex=i(this.dynamicIndex),this.realData=h(this.dynamicData),this.callReady()}else this.normalizeIndex(this.dataTrans,t),a&&this.diff(n,this.dataTrans,0,!0,!(t&&t.length),!0),this.setIndexAndData(this.dataTrans),this.touchs.filter((function(t){return!t.hidden})).forEach((function(t,e){return t.scrollTo(o.realIndex[e]||0)})),this.callReady();this.touchs.filter((function(t){return!t.hidden})).forEach((function(t,e){t.curIndex=t.preIndex=o.realIndex[e]||0}))}}},o.prototype.setValue=function(t){return this._setKeyAndValue("value",t)},o.prototype.setKey=function(t){return this._setKeyAndValue("key",t)},o.prototype._setKeyAndValue=function(t,e){var i=this;return new Promise((function(n,a){var o;u([e],[t],"set"+((o=t).slice(0,1).toUpperCase()+o.slice(1)),a);var s=[],r=0;try{if(i.isGanged){!function i(n){n.forEach((function(n,a){n[t]===e[r]&&(r++,s.push(a),i(n.children))}))}(i.data);for(var h=i.genGangedData(i.data,s),l=s.length;l<h.length;l++)s[l]=0}else i.dataTrans.forEach((function(i,n){var a=i.findIndex((function(i){return i[t]===e[n]}));s.push(-1===a?0:a)}));i._setIndex(s,a),n(i.getChangeCallData())}catch(t){a(t)}}))},o.prototype.setData=function(t,e){var i=this;return new Promise((function(n,o){if(i.isGanged=t.every((function(t){return a(t)})),!i.validateData(t)||e&&!i.validateIndex(e))o("wrong data or index");else{var s=h(i.dataTrans);i.data=h(t),i.normalizeData(),i._setIndex(e||Array.from({length:i.dataTrans.length}).fill(0),o,s,!0),n(i.getChangeCallData())}}))},o.prototype.getData=function(){return this.getChangeCallData()},o.prototype.getIndex=function(){return this.realIndex},o.prototype.getValue=function(){return this.dynamicData.reduce((function(t,e){return t.push(e.value),t}),[])},o.prototype.getKey=function(){return this.dynamicData.reduce((function(t,e){return t.push(e.key),t}),[])},o.prototype.close=function(){return this.closeSelect()},o.prototype.show=function(){return this.showSelect()},o.prototype.destroy=function(){return this.destroySelect()},o.prototype.setLoading=function(){this.loading=!0;var t=n.find("q-select-loading--"+this.id);n.addStyle(t,[{display:"flex"}]),this.touchs.filter((function(t){return!t.hidden})).forEach((function(t){t.shrinkSize()}))},o.prototype.cancelLoading=function(){this.loading=!1;var t=n.find("q-select-loading--"+this.id);n.addStyle(t,{display:"none"}),this.touchs.filter((function(t){return!t.hidden})).forEach((function(t){t.setSize()}))},o.prototype.setTitle=function(t){u([t],["title"],"setTitle")||(n.find("q-select-header-title__value--"+this.id).innerHTML=t)},o}(function(){function t(t){if(this.$options=t||{},t=t||{},this.id=c++,this.target=null,t.target){var e=document.querySelector(t.target);e?this.target=e:s(!1,"can not catch "+t.target+",make sure you have set a right flag of a element")}this.$options.id=this.id,this.count=t.count=o(+t.count)?+t.count:7,this.chunkHeight=t.chunkHeight=o(+t.chunkHeight)?+t.chunkHeight:40,this.data=h(t.data),this.dataTrans=[],this.index=t.index,this.dynamicIndex=[],this.realIndex=[],this.touchs=[],this.dynamicData=[],this.realData=[],this.cachedCall=[],this.isReady=!1,this.isGanged=!1,this.hidden=!0,this.loading=!!t.loading,this.dom=new n,this.validateOptions()&&this.init()}return t.prototype.validateOptions=function(){var t=this;function e(t){this.$options[t]&&"function"!=typeof this.$options[t]&&(r(!1,t+" must be a function but not get "+this.$options[t]),this.$options[t]=function(){})}return this.count%2!=1&&(this.count<5||this.count>9)&&(r(!1,"count can only be 5 or 7 or 9, but now get "+this.count),this.count=this.$options.count=7),(this.chunkHeight<30||this.chunkHeight>60)&&(r(!1,"chunkHeight must greater than 30 and less than 60,but now get "+this.chunkHeight),this.chunkHeight=this.$options.chunkHeight=40),["ready","cancel","confirm","show","close"].map((function(i){return e.call(t,i)})),!(!this.validateData()||!this.validateIndex())},t.prototype.validateData=function(t,e){var i=t||this.$options.data;return(!i||!Array.isArray(i)||Array.isArray(i)&&0===i.length)&&(r(!1,"data can only be an array"),this.data=i=[[""]]),this.isGanged=void 0!==e?e:i.every((function(t){return a(t)})),this.isGanged?function t(e,i){return e.every((function(e){if(a(e)){var n=!0,o=!0;return i?n=s(e.value,"value is required if in the first level of GangedData"):o=s(e.value,"value is required if you use object to define a property of GangedData"),!o&&!n||!e.children||!e.children.length||t(e.children,!1)}return s("string"==typeof e||"number"==typeof e,"value can only be number or string if you use object to define a property of GangedData but now get "+e)}))}(i,!0):i.every((function(t){return Array.isArray(t)?t.every((function(t){return a(t)?t.children&&t.children.length?s(!1,"notGangedData can not has prop which is children"):s(void 0!==t.value,"value is required if NotGangedData is an object"):"string"==typeof t||"number"==typeof t||s(!1,"value can only be number or string if NotGangedData is not an object but now get "+t+" which is "+typeof t)})):(s(!1,"NotGangedData must contain arrays, but now get "+t),!1)}))},t.prototype.validateIndex=function(t){var e=t||this.$options.index;return!e||(Array.isArray(e)?e.every((function(t){return"number"==typeof t||s(!1,"index can only be a number, but now get "+t)})):s(!1,"index must be an Array, but now get "+e))},t.prototype.init=function(){var t=this;this.normalizeData(),this.dom.init(this.dataTrans,this.$options,!!this.target,(function(e){if(!n.find("q-select-bk")&&!t.target){var i=n.create("div");n.addClass(i,"q-select-bk"),n.addStyle(i,[{zIndex:o(+t.$options.bkIndex)?+t.$options.bkIndex:500},{display:"none"}]),document.body.appendChild(i)}var a=n.create("div");n.addClass(a,["q-select","q-select--"+t.id]),t.target?n.addStyle(a,[{position:"static"}]):n.addStyle(a,[{zIndex:o(+t.$options.selectIndex)?+t.$options.selectIndex:600},{display:"none"}]),a.innerHTML=e,t.target?(t.target.appendChild(a),t.hidden=!1):document.body.appendChild(a),t.dom.remove(),t.prepareMount()}))},t.prototype.getDisabledAfterIndex=function(t,e){if(!t||!t[e])return e;for(;t[e].disabled;)if(++e===this.data.length){e--;break}if(e===this.data.length-1)for(;t[e].disabled;)e--;return e},t.prototype.normalizeIndex=function(t,e){var n=this;this.index=e||this.index,this.index=this.index||Array.from({length:t.length}).fill(0),this.index.map((function(e,i){if(e<0&&(n.index[i]=0),t[i]){var a=t[i].length;e>a-1&&(n.index[i]=a-1)}return n.index[i]=n.getDisabledAfterIndex(n.dataTrans[i],n.index[i]),e}));var a=this.index.length-t.length;this.index=a>=0?this.index.slice(0,t.length):i(this.index,Array.from({length:Math.abs(a)}).fill(0)),this.dynamicIndex=i(this.index),this.realIndex=i(this.index)},t.prototype.normalizeData=function(t,e){if(this.isGanged)this.normalizeGangedData(),this.dataTrans=this.genGangedData(this.data);else{if(t)if(Array.isArray(t)&&Array.isArray(e))for(var i=0;i<t.length-1;i++)this.data[e[i]]=t[e[i]];else this.data[e]=t;this.normalizeNotGangedData(),this.dataTrans=h(this.data)}},t.prototype.normalizeGangedData=function(){!function t(e){e.map((function(i,n){return a(i)?i.key=i.key||i.value:e[n]=i={value:i,key:i,children:[]},i.children&&i.children.length?t(i.children):i.children=[],i}))}(this.data)},t.prototype.normalizeNotGangedData=function(){this.data.map((function(t){for(var e in t){var i=t[e];a(i)?i.key=i.key||i.value:t[e]={key:i,value:i}}return t}))},t.prototype.prepareMount=function(){var t=this;this.normalizeIndex(this.dataTrans);var e=n.findAll("q-select-box-item__overlay--"+this.id),i=n.findAll("q-select-box-item-collections--"+this.id),a=n.findAll("q-select-box-item__highlight--"+this.id);this.dynamicData=this.dataTrans.reduce((function(e,i,n){return e[n]=i[t.index[n]]||{},e[n].index=n,e}),[]),this.realData=h(this.dynamicData),this.target||this.mountActions(),this.mountTouches(e,i,a)},t.prototype.mountActions=function(){var t=this,e=n.find("q-select-header-confirm--"+this.id),a=n.find("q-select-header-cancel--"+this.id);function o(){if(this.dynamicIndex=i(this.realIndex),this.isGanged){var t=h(this.dataTrans),e=this.genGangedData(this.data,this.realIndex);this.diff(t,e,0,!0,!1,!0)}this.stopAll()}n.bind(e,"click",(function(){var e;t.touchs.filter((function(t){return!t.hidden})).every((function(t){return!t.isAnimating}))?(t.realIndex=i(t.dynamicIndex),t.realData=h(t.dynamicData)):(t.dynamicData=h(t.realData),o.call(t)),t.closeSelect(),t.$options.confirm&&(e=t.$options).confirm.apply(e,t.getChangeCallData())})),n.bind(a,"click",(function(){t.$options.disableDefaultCancel||t.closeSelect(),o.call(t),t.$options.cancel&&t.$options.cancel()}))},t.prototype.mountTouches=function(t,e,i){var n,a=this;this.dataTrans.forEach((function(n,o){a.touchs[o]=new d(n,o,t[o],e[o],i[o],a.dynamicIndex[o],a,a.touchCallback.bind(a))})),this.setBoxWidth(),this.isReady=!0,this.$options.ready&&(n=this.$options).ready.apply(n,this.getChangeCallData())},t.prototype.closeSelect=function(){var t=this;if(!this.hidden){var e=n.find("q-select--"+this.id),i=n.find("q-select-bk");n.addStyle(i,{display:"none"}),this.slideAnimation("out",e,(function(){var i;n.addStyle(e,{display:"none"}),t.hidden=!0,t.$options.hide&&(i=t.$options).hide.apply(i,t.getChangeCallData())}))}},t.prototype.destroySelect=function(){for(var t in this.touchs.forEach((function(t){return t.destroy()})),n.remove(document.body,n.find("q-select--"+this.id)),0===n.findAll("q-select").length&&n.remove(document.body,n.find("q-select-bk")),this.__proto__=null,this)this[t]=null},t.prototype.showSelect=function(){var t=this;if(this.hidden){var e=n.find("q-select--"+this.id),i=n.find("q-select-bk");n.addStyle(e,{display:"block"}),n.addStyle(i,{display:"block"}),this.slideAnimation("in",e,(function(){var e;t.hidden=!1,t.$options.show&&(e=t.$options).show.apply(e,t.getChangeCallData())}))}},t.prototype.slideAnimation=function(t,e,i){n.addClass(e,["animated","in"===t?"slideInUp":"slideOutDown"]);var a=setTimeout((function(){n.removeClass(e,["animated","in"===t?"slideInUp":"slideOutDown"]),i&&i(),clearTimeout(a)}),200)},t.prototype.stopAll=function(){var t=this;this.touchs.filter((function(t){return!t.hidden})).forEach((function(e,i){e.animateShrink.stop(),e.animateSlide.stop(),e.scrollTo(t.realIndex[i]),e.setMinScrollTop(t.dataTrans[i])}))},t.prototype.setIndexAndData=function(t){var i=this;t.forEach((function(n,a){var o=i.dynamicIndex[a];o>n.length-1&&(i.realIndex[a]=i.dynamicIndex[a]=o=n.length-1),o<0&&(i.realIndex[a]=i.dynamicIndex[a]=o=0),i.dynamicData[a]=e(e({},t[a][o]),{index:o}),i.realData[a]=e(e({},t[a][o]),{index:o})}))},t.prototype.setBoxWidth=function(){var t=n.findAll("q-select-box-item--"+this.id),e=100/this.touchs.filter((function(t){return!t.hidden})).length+"%";t.forEach((function(t){t.style.width=e}))},t.prototype.touchCallback=function(t,e){this.dynamicIndex[e]=t.index,this.target&&(this.realIndex[e]=t.index),this.isGanged?this.gangedCallback(t,e):this.notGangedCallback(t,e)},t.prototype.notGangedCallback=function(t,e){var n;this.dynamicData[e]=t;var a=function(){};if(a.priority=e,this.cachedCall.push(a),this.touchs.every((function(t){return!t.isAnimating}))&&!this.hidden){var o=Math.min.apply(Math,this.cachedCall.reduce((function(t,e){return t.push(+e.priority),t}),[])),s=this.getChangeCallData();this.$options.change&&(n=this.$options).change.apply(n,i([o],s)),this.cachedCall.length=0}},t.prototype.gangedCallback=function(t,e){var i=function(){};i.priority=e,i.value=t;var n=this.touchs.filter((function(t){return!t.hidden}));if(this.cachedCall[e]=i,n.every((function(t){return!t.isAnimating}))){var a=Math.min.apply(Math,this.cachedCall.reduce((function(t,e){return t.push(+e.priority),t}),[]));this.dynamicIndex=this.dynamicIndex.slice(0,a+1);for(var o=a+1;o<n.length;o++)this.dynamicIndex[o]=0;var s=this.genGangedData(this.data,this.dynamicIndex);this.diff(this.dataTrans,s,a,!1,!0)}},t.prototype.getChangeCallData=function(){return[this.dynamicData.reduce((function(t,e){return t.push(e.value),t}),[]),this.dynamicData.reduce((function(t,e){return t.push(e.key),t}),[]),this.dynamicData]},t.prototype.diff=function(t,a,o,s,r,h){var l=this;n.diff(t,a,o,this.id,this.chunkHeight,this.touchs,h,(function(n,c,u){var f;if(a.length>t.length){l.dynamicData[o]=e(e({},a[o][l.dynamicIndex[o]]),{index:l.dynamicIndex[o]});for(var p=h?o:o+1;p<a.length;p++)l.touchs[p]?(l.touchs[p].reset(a[p],r),l.touchs[p].active(p),h&&!r||(l.dynamicIndex[p]=0),l.dynamicData[p]=e(e({},a[p][l.dynamicIndex[p]]),{index:l.dynamicIndex[p]})):(l.touchs[p]=new d(a[p],p,n[p],c[p],u[p],l.dynamicIndex[p],l,l.touchCallback.bind(l)),h&&!r||(l.dynamicIndex[p]=0),l.touchs[p].setSize(),l.dynamicData[p]=e(e({},a[p][l.dynamicIndex[p]]),{index:l.dynamicIndex[p]})),l.setBoxWidth();n&&(n.length=0,c.length=0,u.length=0)}else if(a.length===t.length)l.resetExistTouch(o,a,h,r);else{var y=[];for(p=a.length;p<t.length;p++)l.touchs[p].deactive(p),y.push(p);l.resetExistTouch(o,a,h,r),l.dynamicIndex.splice(y[0],y.length),l.dynamicData.splice(y[0],y.length),y.length=0,l.setBoxWidth()}if(!s){var m=l.getChangeCallData();l.$options.change&&(f=l.$options).change.apply(f,i([o],m))}l.dataTrans=a,l.cachedCall.length=0}))},t.prototype.resetExistTouch=function(t,i,n,a){i[t]&&(this.dynamicData[t]=e(e({},i[t][this.dynamicIndex[t]]),{index:this.dynamicIndex[t]}));for(var o=n?t:t+1;o<this.touchs.filter((function(t){return!t.hidden})).length;o++)n&&!a||(this.dynamicIndex[o]=0),this.dynamicData[o]=e(e({},i[o][this.dynamicIndex[o]]),{index:this.dynamicIndex[o]}),this.touchs[o].reset(i[o],a)},t.prototype.genGangedData=function(t,i){var n=0,a=[];return function t(o){a[n]=[];for(var s=0,r=o;s<r.length;s++){var h=r[s],l=e({},h);delete l.children,a[n].push(l)}var d=(i||[])[n]||0;d=this.getDisabledAfterIndex(a[n],d),n++,o[d]?o[d].children.length&&t.call(this,o[d].children):o[0]&&o[0].children.length&&t.call(this,o[0].children)}.call(this,t),this.completeDynamicIndex(a),a},t.prototype.completeDynamicIndex=function(t){for(var e=0;e<this.dynamicIndex.length;e++)t[e]&&this.dynamicIndex[e]>t[e].length-1&&(this.dynamicIndex[e]=t[e].length-1),this.dynamicIndex[e]<0&&(this.dynamicIndex[e]=0);for(e=this.dynamicIndex.length;e<t.length;e++)this.dynamicIndex[e]=0;this.dynamicIndex=this.dynamicIndex.slice(0,t.length)},t.prototype.callReady=function(){var t;this.$options.ready&&(t=this.$options).ready.apply(t,this.getChangeCallData())},t}())},"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).QSelect=e();